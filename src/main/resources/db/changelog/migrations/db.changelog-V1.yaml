databaseChangeLog:
  - changeSet:
      id: create_users_table
      author: Mykolas
      comment: Creating 'users' table to hold all the existing users.
      changes:
        - createTable:
            tableName: users
            columns:
              - column:
                  name: id
                  type: int
                  autoIncrement: true
              - column:
                  name: email
                  type: varchar(60)
              - column:
                  name: name
                  type: varchar(40)
              - column:
                  name: password
                  type: varchar(40)
              - column:
                  name: token
                  type: varchar(250)
              - column:
                  name: role
                  type: varchar(30)
        - addPrimaryKey:
            columnNames: id
            tableName: users
        - sql:
            sql: ALTER TABLE users ADD CONSTRAINT allow_only_admin_or_user CHECK (role IN ('ROLE_ADMIN','ROLE_USER'))

  - changeSet:
      id: create_messages_table
      author: Mykolas
      comment: Creating 'messages' table that holds all the created messages.
      changes:
        - createTable:
            tableName: messages
            columns:
              - column:
                  name: id
                  type: int
                  autoIncrement: true
              - column:
                  name: author_id
                  type: int
              - column:
                  name: time
                  type: timestamp
              - column:
                  name: length
                  type: int
              - column:
                  name: content
                  type: varchar(400)
              - column:
                  name: receiver_id
                  type: int
        - addPrimaryKey:
            columnNames: id
            tableName: messages
        - addForeignKeyConstraint:
            baseTableName: messages
            baseColumnNames: author_id
            constraintName: author_id_fk
            referencedTableName: users
            referencedColumnNames: id
        - addForeignKeyConstraint:
            baseTableName: messages
            baseColumnNames: receiver_id
            constraintName: receiver_id_fk
            referencedTableName: users
            referencedColumnNames: id

  - changeSet:
      id: add_mock_data_to_db
      author: Mykolas
      comment: Adding mock data to the tables of database.
      changes:
        - insert:
            tableName: users
            columns:
              - column:
                  name: email
                  value: admin@gmail.com
              - column:
                  name: name
                  value: Admin
              - column:
                  name: password
                  value: admin
              - column:
                  name: role
                  value: ROLE_ADMIN
        - insert:
            tableName: users
            columns:
              - column:
                  name: email
                  value: person@gmail.com
              - column:
                  name: name
                  value: VardenisPavardenis
              - column:
                  name: password
                  value: slaptazodis
              - column:
                  name: role
                  value: ROLE_USER
        - insert:
            tableName: user
            columns:
              - column:
                  name: email
                  value: person2@gmail.com
              - column:
                  name: name
                  value: person
              - column:
                  name: password
                  value: secret
              - column:
                  name: role
                  value: ROLE_USER
        - insert:
            tableName: messages
            columns:
              - column:
                  name: author_id
                  value: 1
              - column:
                  name: time
                  value: '2019-06-26'
              - column:
                  name: length
                  value: 39
              - column:
                  name: content
                  value: Trying out sending a message over here.
              - column:
                  name: receiver_id
                  value: 2
        - insert:
            tableName: messages
            columns:
              - column:
                  name: author_id
                  value: 2
              - column:
                  name: time
                  value: '2021-06-26'
              - column:
                  name: length
                  value: 39
              - column:
                  name: content
                  value: Here is another message being sent out.
              - column:
                  name: receiver_id
                  value: 2